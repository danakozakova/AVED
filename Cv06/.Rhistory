knitr::opts_chunk$set(
echo = TRUE,
warning = FALSE,
message = FALSE,
comment = "#>"
)
# rm(list = ls())
trump <- read_csv("exdata06/trump.csv.gz",
col_types = cols(
source = col_character(),
text = col_character(),
created_at = col_character(),
retweet_count = col_integer(),
favorite_count = col_integer(),
is_retweet = col_logical(),
id_str = col_double()))
library(tibble)
library(readr)
library(stringr)
trump <- read_csv("exdata06/trump.csv.gz",
col_types = cols(
source = col_character(),
text = col_character(),
created_at = col_character(),
retweet_count = col_integer(),
favorite_count = col_integer(),
is_retweet = col_logical(),
id_str = col_double()))
trump <- read_csv("trump.csv.gz",
col_types = cols(
source = col_character(),
text = col_character(),
created_at = col_character(),
retweet_count = col_integer(),
favorite_count = col_integer(),
is_retweet = col_logical(),
id_str = col_double()))
View(trump)
trunp <- trump[!trump$is_retweet, ]
trump <- trump[!trump$is_retweet, ]
View(trunp)
rm(list = ls())
trump <- read_csv("trump.csv.gz",
col_types = cols(
source = col_character(),
text = col_character(),
created_at = col_character(),
retweet_count = col_integer(),
favorite_count = col_integer(),
is_retweet = col_logical(),
id_str = col_double()))
trump <- trump[!trump$is_retweet, ]
? regex
regex(pattern = "obama", ignore_case = FALSE)
trump$text |> str_count(regex(pattern = "obama", ignore_case = FALSE))
regex(pattern = "obama", ignore_case = TRUE)
trump$text |> str_count(regex(pattern = "obama", ignore_case = TRUE)) |>
sum()
trump$text |> str_count(regex(pattern = "obama", ignore_case = TRUE))
trump$text |> str_count(regex(pattern = "trump", ignore_case = TRUE)) |>
sum()
positive_words <- c("good", "excellent", "perfect", "correct", "nice")
positive_regex <- str_c("\\b(", str_c(positive_words, collapse = "|"), ")\\b")
positive_regex
positive_words <- c("good", "excellent", "perfect", "correct", "nice")
positive_words <- positive_words |> str_c(collapse = "|")
positive_words
positive_regex <- str_c("\\b(", positive_words, ")\\b")
positive_regex <- str_c("\\b(", positive_words, ")\\b") |> regex(ignore_case = TRUE)
sum(str_count(trump$text, positive_regex))
trump$text |> str_count(positive_regex) |> sum()
# alebo natvrdo napísat slova do regularneho vyrazu
trump$text |> str_count(regex("\\b(poor|bad|wrong|awful|incorrect)\\b",
ignore_case = TRUE)) |>
sum()
day <- trump$created_at |> str_sub(start = 1, end = 3)
day |> table()
day |> table() |> prop.table()
days
days <- tibble(day = names(day), frequency = as.vector(day))
days
day <- trump$created_at |> str_sub(start = 1, end = 3)
day |> table()
day |> table() |> prop.table()
days <- tibble(day = names(day), frequency = as.vector(day))
days
day <- trump$created_at |> str_sub(start = 1, end = 3)
day |> table()
day <- day |> table() |> prop.table()
day
days <- tibble(day = names(day), frequency = as.vector(day))
days
day
den <- str_sub(trump$created_at, end = 3)
den <- prop.table(table(den))
den <- tibble(day = names(den), frequency = as.vector(den))
den <- den[order(den$frequency, decreasing = TRUE), ]
den
den <- prop.table(table(den))
den
den <- str_sub(trump$created_at, end = 3)
den
day <- trump$created_at |> str_sub(start = 1, end = 3)
day
den
day <- day |> table() |> prop.table()
day
den <- prop.table(table(den))
den
den <- tibble(day = names(den), frequency = as.vector(den))
days <- tibble(day = names(day), frequency = as.vector(day))
days
den
den
den
day
days
den
day <- trump$created_at |> str_sub(start = 1, end = 3)
day |> table()
day <- day |> table() |> prop.table()
den <- str_sub(trump$created_at, end = 3)
den <- prop.table(table(den))
den |> class()
day |> class()
xx <- tibble(day = names(day), frequency = as.vector(day))
xx
xx <- tibble(day = names(den), frequency = as.vector(den))
xx
day
den
xx <- tibble(day = names(day), frequency = as.vector(den))
xx
xx <- tibble(day = names(day), frequency = as.vector(day))
xx
day |> str()
den |> str()
? str_sub
day <- str_sub(trump$created_at, end = 3)
day <- day |> table() |> prop.table()
tibble(day = names(day), frequency = as.vector(day))
day <- prop.table(table(day))
tibble(day = names(day), frequency = as.vector(day))
day <- trump$created_at |> str_sub(start = 1, end = 3)
day |> table()
day <- day |> table() |> prop.table()
day
days <- tibble(day = names(day), frequency = as.vector(day))
days
days
day <- trump$created_at |> str_sub(start = 1, end = 3)
day |> table()
day <- day |> table() |> prop.table()
day
days <- tibble(day = names(day), frequency = as.numeric(day))
days
days
days
as.vector(day)
days <- tibble(day = names(day), frequency = as.vector(day))
days
days <- tibble(frequency = as.vector(day))
days
days |> table() |>
prop.table() |>
tibble(day = names(den), frequency = as.vector(day))
days <- trump$created_at |> str_sub(start = 1, end = 3)
days |> table()
days |> table() |> prop.table()
days <- days |> table() |> prop.table()
days |> tibble(day = names(den), frequency = as.vector(day))
days
days <- trump$created_at |> str_sub(start = 1, end = 3)
days |> table()
days <- days |> table() |> prop.table()
days
days <- days |> tibble(day = names(den), frequency = as.vector(day))
days
days <- days[order(days$frequency, decreasing = TRUE),]
days
days <- trump$created_at |> str_sub(start = 1, end = 3)
days
days <- days |> table() |> prop.table()
days
days <- days |> tibble(day = names(days), frequency = as.vector(days))
days
day_c <- trump$created_at |> str_sub(start = 1, end = 3)
day_c |> table()
day-c <- day_c |> table() |> prop.table()
day_c <- trump$created_at |> str_sub(start = 1, end = 3)
day_c |> table()
day-c <- day_c |> table() |> prop.table()
day_c <- day_c |> table() |> prop.table()
day_c
days <- days |> tibble(day = names(day_c), frequency = as.vector(day_c))
day_c <- day_c |> table() |> prop.table()
day_c
day_c
rm(list = ls())
day_c <- trump$created_at |> str_sub(start = 1, end = 3)
day_c <- trump$created_at |> str_sub(start = 1, end = 3)
knitr::opts_chunk$set(
echo = TRUE,
warning = FALSE,
message = FALSE,
comment = "#>"
)
# rm(list = ls())
# Načítajte potrebné balíky: tibble, readr, stringr
library(tibble)
library(readr)
library(stringr)
# Vytvorte vektor 'jmena' s 30 názvami súborov formátu "data001.csv"
str_pad(string = 1:30, width = 3, side = "left", pad = "0") |> # vytvorenie 001 az 030
head(10)
jmena <- str_c("data",
str_pad(1:30, width = 3, side = "left", pad = "0"), ".csv")
# zobraz prvých 10 názvov
jmena |> head(10)
jmena |> length()
jmena |> str_length()
# Načítajte dáta
load("exdata06.RData")
# Pozrite si štruktúru tabulky 'measurement'
# 1. Extrahujte rok (prvé 4 znaky)
measurement$year <- str_sub(measurement$time, 1, 4)|> as.integer()
measurement$year |> head(10)
# 2. Extrahujte mesiac (znaky 5-6)
measurement$month <- str_sub(measurement$time,5, 6)|> as.integer()
measurement$month |> head(10)
# 3. Extrahujte deň (znaky 7-8)
measurement$day <- str_sub(measurement$time,7, 8)|> as.integer()
measurement$day |> head(10)
# Ina moznost extrahovania datumu
library(lubridate, quietly = TRUE)
measurement$time |> ymd() |> year() |> head(10)
measurement$time |> ymd() |> month() |> head(10)
measurement$time |> ymd() |> day() |> head(10)
# 4. Odstráňte medzery zo stĺpca 'class'
measurement$class |> head()
measurement$class <- str_trim(measurement$class)
measurement$class |> head()
# 5. Preusporiadajte stĺpce
measurement |> colnames()
measurement <- measurement[, c("year", "month", "day", "class", "measurement")]
measurement |> colnames()
# Vypíšte výsledok
measurement |> head()
deklarace |> head(2)
# 1. Logický vektor: kde sú duplicitné medzery?
# Použite regex \\s{2,}
# pattern: prazdny znak (\s) zopakovany dva a viackrát({2,})
str_detect(string = deklarace, pattern = "\\s{2,}")
# 2. Počet duplicitných medzier v každom prvku
str_count(deklarace, "\\s{2,}")
# 3. Odstránenie duplicitných medzier
# Spôsob 1: str_replace_all()
# parametre: text, co nahradit, cim nahradit
str_replace_all(string = deklarace, pattern = "\\s+", replacement = " ") |> head(5)
# Spôsob 2: str_squish() (jednoduchšie)
str_squish(deklarace) |> head(5)
deklarace <- str_squish(deklarace)
deklarace[2] |> str_wrap(width = 60) |> cat()
# Načítajte TSV súbor (tab-separated values)
# col_types = "cnnnnnnnnnnnn" (1 character + 12 numeric stĺpcov)
tec00001tsv <- read_tsv("tec00001.tsv.gz",
col_types = "cnnnnnnnnnnnn")
# Vypíšte hlavičku
head(tec00001tsv)
# Spôsob 1: str_split() a manuálne priradenie
mat <- str_split(string = tec00001tsv$`na_item,unit,geo\\time`,
pattern = ",",
simplify = TRUE)
mat |> dim()
mat |> class()
mat |> head(5)
# vezme stlpec, zoberie riadky a rozdeli ho podla ciarky
tec00001tsv_copy <- tec00001tsv
tec00001tsv_copy$item <- mat[,1]
tec00001tsv_copy$item |> head(5)
tec00001tsv_copy$unit <- mat[,2]
tec00001tsv_copy$unit |> head(5)
tec00001tsv_copy$geo <- mat[,3]
tec00001tsv_copy$geo |> head(5)
# Spôsob 1a:
# vezmi string v prvom stlpci, oddelovacom je ","
tec00001tsv_copy2 <- tec00001tsv
tec00001tsv_copy2$item <- str_split_i(string = tec00001tsv_copy2[[1]],
pattern = ',',
i = 1)
tec00001tsv_copy2$unit <- str_split_i(string = tec00001tsv_copy2[[1]],
pattern = ',',
i = 2)
tec00001tsv_copy2$geo <- str_split_i(string = tec00001tsv_copy2[[1]],
pattern = ',',
i = 3)
# Spôsob 2: str_split_fixed() a cbind()
mat <- str_split_fixed(tec00001tsv[[1]], ",", 3) # rozdeli na 3 stlpce
mat |> dim()
mat |> class()
mat |> head(5)
colnames(mat) <- c("item", "unit", "geo")
mat |> head(5)
mat <- as_tibble(mat)
mat |> class()
tec00001tsv_copy3 <- as_tibble(cbind(mat, tec00001tsv[, -1]))
# Spôsob 3: tidyr::separate_wider_delim() (najjednoduchší)
tec00001tsv_copy4 <- tec00001tsv
tec00001tsv_copy4[, c("item", "unit", "geo")] <- str_split_fixed(string = tec00001tsv[[1]],
pattern = ',',
n = 3)
# zmena poradia stlpcov, vyhodenie prveho
# pre vsetky sposoby okrem 1a
col_no <- tec00001tsv_copy |> colnames() |> length()
tec00001tsv_copy <- tec00001tsv_copy[, c((col_no - 2) : col_no, 2 : (col_no - 3))] # c(14:16, 2:13)
tec00001tsv_copy |> head(5)
tec00001tsv_delim <- tidyr::separate_wider_delim(data = tec00001tsv,
cols = `na_item,unit,geo\\time`,
delim = ',',
names = c('item', 'unit', 'geo'))
tec00001tsv_delim |> head()
# Načítajte súbor po riadkoch
shopping <- read_lines('shops.txt')
# Vypíšte prvých 6 riadkov pomocou cat()
shopping |> head(6) |> cat(sep = "\n")
# Najprv nahraďte "zdarma" za "0 Kč"
shopping <- shopping |> str_replace("zdarma", "0 Kč")
shopping |> head()
# Vytvorte tabulku s 4 stĺpcami
# 1. Extrahujte názov obchodu (od začiatku po prvú medzeru)
shop <- str_extract(shopping, "^[-\\w]+")
shop |> head()
# 2. Extrahujte cenu (číslo z "cena: ... Kč")
# Vysvetlenie vyrazu:
# cena:\\s*(\\d+\\s*\\.?\\s*\\d*)\\s*Kč"
# \\s* - nula nebo více bílých znaků (mezery, tabulátory)
# \\d+ = jedna nebo více číslic (povinné)
# \\.? = nepovinná tečka (desetinný oddělovač) - ? znamená 0 nebo 1x
# \\d* = nula nebo více číslic (desetinná část - nepovinná)
price <- str_extract(shopping, "cena:\\s*\\d+\\s*\\.?\\s*\\d*\\s*Kč") |>
str_remove_all("[\\s,\\.]") |>
str_extract("\\d+") |>
as.numeric()
# 3. Extrahujte dopravu (číslo z "doprava: ... Kč")
shipping <- str_extract(shopping, "doprava:\\s*\\d+\\s*Kč") |>
str_extract("\\d+") |>
as.numeric()
# 4. Vypočítajte celkovú cenu
total_price <- price + shipping
# Vypíšte výsledok
shops <- tibble(shop, price, shipping, total_price)
shops |> head()
# Nájdite obchod s minimálnou celkovou cenou
shops[shops$total_price == min(shops$total_price, na.rm = TRUE),]
trump <- read_csv("trump.csv.gz",
col_types = cols(
source = col_character(),
text = col_character(),
created_at = col_character(),
retweet_count = col_integer(),
favorite_count = col_integer(),
is_retweet = col_logical(),
id_str = col_double()))
trump <- trump[!trump$is_retweet, ]
regex(pattern = "obama", ignore_case = TRUE)
trump$text |> str_count(regex(pattern = "obama", ignore_case = TRUE)) |>
sum()
trump$text |> str_count(regex(pattern = "trump", ignore_case = TRUE)) |>
sum()
positive_words <- c("good", "excellent", "perfect", "correct", "nice")
positive_words <- positive_words |> str_c(collapse = "|")
positive_regex <- str_c("\\b(", positive_words, ")\\b") |> regex(ignore_case = TRUE)
trump$text |> str_count(positive_regex) |> sum()
# alebo natvrdo napísat slova do regularneho vyrazu
trump$text |> str_count(regex("\\b(poor|bad|wrong|awful|incorrect)\\b",
ignore_case = TRUE)) |>
sum()
day_c <- trump$created_at |> str_sub(start = 1, end = 3)
day_c |> table()
day_c <- day_c |> table() |> prop.table()
day_c
days <- days |> tibble(day = names(day_c), frequency = as.vector(day_c))
days <- day_c |> tibble(day = names(day_c), frequency = as.vector(day_c))
days
days <- tibble(day = names(day_c), frequency = as.vector(day_c))
days
days <- days[order(days$frequency, decreasing = TRUE),]
days
str_match(string = trump$created_at,
pattern = '(\\d{2}):\\d{2}:\\d{2}')
? str_match
# najdi HH:MM:SS
# str_match(trump$created_at, '(\\d{2}):\\d{2}:\\d{2}')
#        [,1]       [,2]
# [1,] "14:30:45"  "14"   <- celý match | skupina 1
# [2,] "09:15:22"  "09"
# [3,] "23:59:01"  "23"
# Stĺpec 1 [,1]: celý match (HH:MM:SS)
# Stĺpec 2 [,2]: prvá capturing group (\\d{2}) = hodiny
hour <- str_match(string = trump$created_at,
pattern = '(\\d{2}):\\d{2}:\\d{2}')[,2]
hour |> head()
hour |> head()
hour |> class()
hist(as.numeric(hour))
# vyber osob
osoby <- str_extract_all(trump$text, '@[a-zA-Z0-9_]{1,15}') |> unlist()
osoby
# bez zavinaca
osoby <- str_replace(osoby, "@", "")
osoby
# tabulka
osoby <- table(osoby)
osoby
osoby <- tibble(person = names(osoby), count = as.integer(osoby))
osoby <- tibble(person = names(osoby), count = as.integer(osoby))
# tabulka
osoby <- table(osoby)
osoby <- tibble(person = names(osoby), count = as.integer(osoby))
osoby
# vyber osob
osoby <- str_extract_all(trump$text, '@[a-zA-Z0-9_]{1,15}') |> unlist()
# bez zavinaca
osoby <- str_replace(osoby, '@', '')
# tabulka
osoby <- table(osoby)
osoby <- tibble(person = names(osoby), count = as.integer(osoby))
osoby
days <- trump$created_at |> str_sub(start = 1, end = 3)
days <- days |> table() |> prop.table()
days <- tibble(day = names(days), count = as.integer(days))
days
days <- trump$created_at |> str_sub(start = 1, end = 3)
days <- days |> table() |> prop.table()
days
days <- tibble(day = names(days), count = as.integer(days))
days
# tabulka
osoby <- table(osoby)
osoby <- tibble(person = names(osoby), count = as.integer(osoby))
osoby <- osoby[order(osoby$count, decreasing = TRUE), ]
osoby
rm(list = ls())
str_subset(string = trump$text, pattern = 'Macron')
