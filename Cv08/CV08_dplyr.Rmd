---
title: "CviÄenÃ­ 8: dplyr - ManipulÃ¡cia s dÃ¡tami"
subtitle: "MPE_AVED - AnalÃ½za a vizualizace ekonomickÃ½ch dat"
author: "VaÅ¡e meno"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
    theme: cosmo
    highlight: tango
    code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  comment = "#>"
)
```

# ğŸ“š Ãšvod

V tomto cviÄenÃ­ si procviÄÃ­te pouÅ¾Ã­vÃ¡nÃ­ zÃ¡kladnÃ­ch nÃ¡strojÅ¯ z balÃ­ku **dplyr**, kterÃ© znÃ¡te z pÅ™ednÃ¡Å¡ky:

- **`select()`** - vÃ½bÄ›r sloupcÅ¯
- **`filter()`** - filtrovÃ¡nÃ­ Å™Ã¡dkÅ¯
- **`arrange()`** - Å™azenÃ­ dat
- **`mutate()`** - vytvÃ¡Å™enÃ­ novÃ½ch promÄ›nnÃ½ch
- **`summarise()`** - agregace dat
- **`group_by()`** - seskupovÃ¡nÃ­ dat
- **`*_join()`** - spojovÃ¡nÃ­ tabulek

# ğŸ“¦ NaÄÃ­tÃ¡nÃ­ balÃ­kÅ¯

```{r packages}
# NaÄtÄ›te potÅ™ebnÃ© balÃ­ky


```

---

# ğŸ”¥ CviÄenÃ­ na rozcviÄenÃ­

```{r ukol_rozehnuti_data}
# NaÄtenÃ­ a prozkoumÃ¡nÃ­ dat


```

```{r ukol_rozehnuti}
# Transformace dat pomocÃ­ dplyr funkcÃ­


```

---

# ğŸ›ï¸ CviÄenÃ­ 1: Privatizace a restituce v ÄŒR

Analyzujte data o privatizaci a restituci v ÄŒeskÃ© republice.

## NaÄtenÃ­ dat

```{r ukol_1_nacteni}
# NaÄtÄ›te data


# ZobrazenÃ­ dat


```

## Ãškol 1.1: FiltrovÃ¡nÃ­ a vÃ½bÄ›r

```{r ukol_1_1}
# Filtrujte data podle zadanÃ½ch kritÃ©riÃ­


```

## Ãškol 1.2: Tvorba novÃ½ch promÄ›nnÃ½ch

```{r ukol_1_2}
# VytvoÅ™te novÃ© promÄ›nnÃ© pomocÃ­ mutate()


```

## Ãškol 1.3: SeskupenÃ­ a agregace

```{r ukol_1_3}
# Seskupte data a vypoÄÃ­tejte agregaÄnÃ­ statistiky


```

---

# ğŸ“Š CviÄenÃ­ 2: Census v otevÅ™enÃ½ch datech ÄŒSÃš

PrÃ¡ce s otevÅ™enÃ½mi daty z ÄŒeskÃ©ho statistickÃ©ho ÃºÅ™adu.

## NaÄtenÃ­ dat

```{r ukol_2_nacteni}
# NaÄtÄ›te census data


# ZobrazenÃ­ struktury dat


```

## Ãškol 2.1: VÃ½bÄ›r relevantnÃ­ch sloupcÅ¯

```{r ukol_2_1}
# Vyberte relevantnÃ­ sloupce pomocÃ­ select()


```

## Ãškol 2.2: FiltrovÃ¡nÃ­ a Å™azenÃ­

```{r ukol_2_2}
# Filtrujte data a seÅ™aÄte je


```

## Ãškol 2.3: KomplexnÃ­ transformace

```{r ukol_2_3}
# Kombinujte vÃ­ce dplyr operacÃ­


```

---

# ğŸŒ CviÄenÃ­ 3: WIID data

AnalÃ½za dat o pÅ™Ã­jmovÃ© nerovnosti z World Income Inequality Database.

## NaÄtenÃ­ dat

```{r ukol_3_nacteni}
# NaÄtÄ›te WIID data


# ZobrazenÃ­ prvnÃ­ch Å™Ã¡dkÅ¯


```

## Ãškol 3.1: ExplorativnÃ­ analÃ½za

```{r ukol_3_1}
# Prozkoumejte strukturu dat


```

## Ãškol 3.2: Agregace podle skupin

```{r ukol_3_2}
# Seskupte data a vypoÄÃ­tejte statistiky


```

## Ãškol 3.3: VytvoÅ™enÃ­ souhrnnÃ© tabulky

```{r ukol_3_3}
# VytvoÅ™te souhrnnou tabulku s klÃ­ÄovÃ½mi metrikami


```

---

# ğŸ”— CviÄenÃ­ 4: SpojovÃ¡nÃ­ tabulek

ProcviÄenÃ­ rÅ¯znÃ½ch typÅ¯ joinÅ¯.

## PÅ™Ã­prava dat

```{r ukol_4_priprava}
# VytvoÅ™te nebo naÄtÄ›te testovacÃ­ tabulky


```

## Ãškol 4.1: Inner join

```{r ukol_4_1}
# ProveÄte inner join


```

## Ãškol 4.2: Left join

```{r ukol_4_2}
# ProveÄte left join


```

## Ãškol 4.3: Full join

```{r ukol_4_3}
# ProveÄte full join


```

## Ãškol 4.4: Anti join

```{r ukol_4_4}
# PouÅ¾ijte anti join pro identifikaci neshod


```

---

# ğŸ”„ CviÄenÃ­ 5: NahrazenÃ­ chybÄ›jÃ­cÃ­ch hodnot

PrÃ¡ce s chybÄ›jÃ­cÃ­mi hodnotami v datech.

## NaÄtenÃ­ dat s NA

```{r ukol_5_nacteni}
# NaÄtÄ›te data s chybÄ›jÃ­cÃ­mi hodnotami


# ZjistÄ›te poÄet NA v jednotlivÃ½ch sloupcÃ­ch


```

## Å˜eÅ¡enÃ­ Ãºkolu 1: OdstranÄ›nÃ­ Å™Ã¡dkÅ¯ s NA

```{r ukol_5_reseni_1}
# OdstraÅˆte Å™Ã¡dky obsahujÃ­cÃ­ NA


```

## Å˜eÅ¡enÃ­ Ãºkolu 2: NahrazenÃ­ NA konkrÃ©tnÃ­mi hodnotami

```{r ukol_5_reseni_2}
# NahraÄte NA vhodnÃ½mi hodnotami


```

## Å˜eÅ¡enÃ­ Ãºkolu 3: KomplexnÃ­ Å™eÅ¡enÃ­ s group_by

```{r ukol_5_reseni_3}
# PouÅ¾ijte skupinovÃ© operace pro nahrazenÃ­ NA


```

---

# ğŸ“ PÅ™ehled funkcÃ­ dplyr

## ZÃ¡kladnÃ­ transformace

```r
# VÃ½bÄ›r sloupcÅ¯
select(data, col1, col2)
select(data, starts_with("prefix"))
select(data, -col_to_remove)

# FiltrovÃ¡nÃ­ Å™Ã¡dkÅ¯
filter(data, condition)
filter(data, col1 > 10, col2 == "value")

# Å˜azenÃ­
arrange(data, col1)
arrange(data, desc(col2))

# VytvÃ¡Å™enÃ­ novÃ½ch promÄ›nnÃ½ch
mutate(data, new_col = expression)
mutate(data, new_col1 = expr1, new_col2 = expr2)
```

## Agregace a seskupenÃ­

```r
# SeskupenÃ­
group_by(data, col1, col2)

# Agregace
summarise(data, mean_val = mean(col), sum_val = sum(col))

# PoÄÃ­tÃ¡nÃ­
count(data, col1, col2)
n()
n_distinct()
```

## SpojovÃ¡nÃ­ tabulek

```r
# Inner join - pouze Å™Ã¡dky se shodou v obou tabulkÃ¡ch
inner_join(x, y, by = "key")

# Left join - vÅ¡echny Å™Ã¡dky z x
left_join(x, y, by = "key")

# Right join - vÅ¡echny Å™Ã¡dky z y
right_join(x, y, by = "key")

# Full join - vÅ¡echny Å™Ã¡dky z obou tabulek
full_join(x, y, by = "key")

# Semi join - Å™Ã¡dky z x se shodou v y (bez sloupcÅ¯ z y)
semi_join(x, y, by = "key")

# Anti join - Å™Ã¡dky z x BEZ shody v y
anti_join(x, y, by = "key")
```

---

# ğŸ’¡ DÅ¯leÅ¾itÃ© poznÃ¡mky

## Pipe operÃ¡tor %>%

Pipe operÃ¡tor umoÅ¾Åˆuje Å™etÄ›zenÃ­ operacÃ­:

```r
# MÃ­sto:
result <- function3(function2(function1(data)))

# PouÅ¾ijte:
result <- data %>%
  function1() %>%
  function2() %>%
  function3()
```

## ÄŒastÃ© problÃ©my a Å™eÅ¡enÃ­

### ProblÃ©m 1: JmÃ©na sloupcÅ¯ s mezerami

```r
# âŒ CHYBA
select(data, column name)

# âœ… Å˜EÅ ENÃ
select(data, `column name`)
```

### ProblÃ©m 2: ZapomenutÃ­ ungroup()

```r
# âŒ NebezpeÄnÃ© - data zÅ¯stÃ¡vajÃ­ seskupenÃ¡
data %>%
  group_by(id) %>%
  mutate(mean_val = mean(value))

# âœ… BezpeÄnÃ©
data %>%
  group_by(id) %>%
  mutate(mean_val = mean(value)) %>%
  ungroup()
```

### ProblÃ©m 3: PouÅ¾itÃ­ summarise() vs mutate()

```r
# summarise() - redukuje poÄet Å™Ã¡dkÅ¯
data %>%
  group_by(group) %>%
  summarise(mean_val = mean(value))  # Jeden Å™Ã¡dek na skupinu

# mutate() - zachovÃ¡vÃ¡ poÄet Å™Ã¡dkÅ¯
data %>%
  group_by(group) %>%
  mutate(mean_val = mean(value))  # StejnÃ½ poÄet Å™Ã¡dkÅ¯ jako pÅ¯vodnÃ­ data
```

---

# ğŸ¯ Checklist

- [ ] RozumÃ­m rozdÃ­lu mezi `select()` a `filter()`?
- [ ] VÃ­m, kdy pouÅ¾Ã­t `mutate()` a `summarise()`?
- [ ] DokÃ¡Å¾u efektivnÄ› pouÅ¾Ã­vat pipe operÃ¡tor `%>%`?
- [ ] ChÃ¡pu rozdÃ­ly mezi rÅ¯znÃ½mi typy joinÅ¯?
- [ ] VÃ­m, jak pracovat s chybÄ›jÃ­cÃ­mi hodnotami?
- [ ] UmÃ­m kombinovat vÃ­ce dplyr operacÃ­ dohromady?

---

# ğŸ”— UÅ¾iteÄnÃ© odkazy

- [dplyr cheatsheet](https://github.com/rstudio/cheatsheets/blob/main/data-transformation.pdf)
- [R for Data Science - Data transformation](https://r4ds.had.co.nz/transform.html)
- [dplyr documentation](https://dplyr.tidyverse.org/)


